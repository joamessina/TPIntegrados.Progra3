<%- include('partials/header') %>
<%- include('partials/navbar') %>

<h1>Panel de Administración</h1>
<a href="/admin/productos/nuevo" class="btn btn-primary">Agregar Producto</a>
<table border="1">
  <tr>
    <th>ID</th>
    <th>Nombre</th>
    <th>Tipo</th>
    <th>Expansión</th>
    <th>Precio</th>
    <th>Activo</th>
    <th>Imagen</th>
    <th>Acciones</th>
  </tr>
  <% productos.forEach(p => { %>
    <tr>
      <td><%= p.id %></td>
      <td><%= p.nombre %></td>
      <td><%= p.tipo %></td>
      <td><%= p.expansion %></td>
      <td>$<%= p.precio %></td>
      <td><%= p.activo ? 'Sí' : 'No' %></td>
      <td>
  <% if (p.imagen) { %>
    <img src="/images/<%= p.imagen %>" alt="Imagen" style="max-width:80px; max-height:80px;">
  <% } else { %>
    (Sin imagen)
  <% } %>
</td>

      <td>
        <a href="/admin/productos/<%= p.id %>/editar" class="btn">Editar</a>
        <% if (p.activo) { %>
          <form method="POST" action="/admin/productos/<%= p.id %>/desactivar" style="display:inline;">
            <button type="submit">Desactivar</button>
          </form>
        <% } else { %>
          <form method="POST" action="/admin/productos/<%= p.id %>/activar" style="display:inline;">
            <button type="submit">Activar</button>
          </form>
        <% } %>
        <form method="POST" action="/admin/productos/<%= p.id %>/eliminar" style="display:inline;">
          <button type="submit" onclick="return confirm('¿Eliminar este producto?');">Eliminar</button>
        </form>
      </td>
    </tr>
  <% }); %>
</table>

<%- include('partials/footer') %>
